./kct-admin-hub/dist/assets/index-mDUJLABa.js:`);const B=await A.signMessage(new TextEncoder().encode(R),"utf8");if(!B||!(B instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");T=B}}try{const{data:O,error:Q}=await ce(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:R,signature:nv(T)},!((b=r.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(E=r.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:hr});if(Q)throw Q;return!O||!O.session||!O.user?{data:{user:null,session:null},error:new Ga}:(O.session&&(await this._saveSession(O.session),await this._notifyAllSubscribers("SIGNED_IN",O.session)),{data:Object.assign({},O),error:Q})}catch(O){if(se(O))return{data:{user:null,session:null},error:O};throw O}}async _exchangeCodeForSession(r){const s=await pn(this.storage,`${this.storageKey}-code-verifier`),[i,l]=(s??"").split("/");try{const{data:d,error:f}=await ce(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:i},xform:hr});if(await Mr(this.storage,`${this.storageKey}-code-verifier`),f)throw f;return!d||!d.session||!d.user?{data:{user:null,session:null,redirectType:null},error:new Ga}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:Object.assign(Object.assign({},d),{redirectType:l??null}),error:f})}catch(d){if(se(d))return{data:{user:null,session:null,redirectType:null},error:d};throw d}}async signInWithIdToken(r){try{const{options:s,provider:i,token:l,access_token:d,nonce:f}=r,p=await ce(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:l,access_token:d,nonce:f,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:hr}),{data:m,error:v}=p;return v?{data:{user:null,session:null},error:v}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Ga}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:v})}catch(s){if(se(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithOtp(r){var s,i,l,d,f;try{if("email"in r){const{email:p,options:m}=r;let v=null,y=null;this.flowType==="pkce"&&([v,y]=await os(this.storage,this.storageKey));const{error:w}=await ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:p,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},create_user:(i=m==null?void 0:m.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:v,code_challenge_method:y},redirectTo:m==null?void 0:m.emailRedirectTo});return{data:{user:null,session:null},error:w}}if("phone"in r){const{phone:p,options:m}=r,{data:v,error:y}=await ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:p,data:(l=m==null?void 0:m.data)!==null&&l!==void 0?l:{},create_user:(d=m==null?void 0:m.shouldCreateUser)!==null&&d!==void 0?d:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},channel:(f=m==null?void 0:m.channel)!==null&&f!==void 0?f:"sms"}});return{data:{user:null,session:null,messageId:v==null?void 0:v.message_id},error:y}}throw new Ja("You must provide either an email or phone number.")}catch(p){if(se(p))return{data:{user:null,session:null},error:p};throw p}}async verifyOtp(r){var s,i;try{let l,d;"options"in r&&(l=(s=r.options)===null||s===void 0?void 0:s.redirectTo,d=(i=r.options)===null||i===void 0?void 0:i.captchaToken);const{data:f,error:p}=await ce(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:d}}),redirectTo:l,xform:hr});if(p)throw p;if(!f)throw new Error("An error occurred on token verification.");const m=f.session,v=f.user;return m!=null&&m.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:v,session:m},error:null}}catch(l){if(se(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithSSO(r){var s,i,l;try{let d=null,f=null;return this.flowType==="pkce"&&([d,f]=await os(this.storage,this.storageKey)),await ce(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(i=(s=r.options)===null||s===void 0?void 0:s.redirectTo)!==null&&i!==void 0?i:void 0}),!((l=r==null?void 0:r.options)===null||l===void 0)&&l.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:f}),headers:this.headers,xform:kv})}catch(d){if(se(d))return{data:null,error:d};throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:s},error:i}=r;if(i)throw i;if(!s)throw new Ur;const{error:l}=await ce(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:s.access_token});return{data:{user:null,session:null},error:l}})}catch(r){if(se(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const s=`${this.url}/resend`;if("email"in r){const{email:i,type:l,options:d}=r,{error:f}=await ce(this.fetch,"POST",s,{headers:this.headers,body:{email:i,type:l,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:f}}else if("phone"in r){const{phone:i,type:l,options:d}=r,{data:f,error:p}=await ce(this.fetch,"POST",s,{headers:this.headers,body:{phone:i,type:l,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:p}}throw new Ja("You must provide either an email or phone number and a type")}catch(s){if(se(s))return{data:{user:null,session:null},error:s};throw s}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async s=>s))}async _acquireLock(r,s){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),l=(async()=>(await i,await s()))();return this.pendingInLock.push((async()=>{try{await l}catch{}})()),l}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=s();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const l=[...this.pendingInLock];await Promise.all(l),this.pendingInLock.splice(0,l.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const s=await this.__loadSession();return await r(s)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const s=await pn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",s),s!==null&&(this._isValidSession(s)?r=s:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const i=r.expires_at?r.expires_at*1e3-Date.now()<cu:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",r.expires_at),!i){if(this.userStorage){const f=await pn(this.userStorage,this.storageKey+"-user");f!=null&&f.user?r.user=f.user:r.user=fu()}if(this.storage.isServer&&r.user){let f=this.suppressGetSessionWarning;r=new Proxy(r,{get:(m,v,y)=>(!f&&v==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),f=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,v,y))})}return{data:{session:r},error:null}}const{session:l,error:d}=await this._callRefreshToken(r.refresh_token);return d?{data:{session:null},error:d}:{data:{session:l},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:Fr}):await this._useSession(async s=>{var i,l,d;const{data:f,error:p}=s;if(p)throw p;return!(!((i=f.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ur}:await ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(d=(l=f.session)===null||l===void 0?void 0:l.access_token)!==null&&d!==void 0?d:void 0,xform:Fr})})}catch(s){if(se(s))return Gy(s)&&(await this._removeSession(),await Mr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:s};throw s}}async updateUser(r,s={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,s))}async _updateUser(r,s={}){try{return await this._useSession(async i=>{const{data:l,error:d}=i;if(d)throw d;if(!l.session)throw new Ur;const f=l.session;let p=null,m=null;this.flowType==="pkce"&&r.email!=null&&([p,m]=await os(this.storage,this.storageKey));const{data:v,error:y}=await ce(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:s==null?void 0:s.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:p,code_challenge_method:m}),jwt:f.access_token,xform:Fr});if(y)throw y;return f.user=v.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),{data:{user:f.user},error:null}})}catch(i){if(se(i))return{data:{user:null},error:i};throw i}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new Ur;const s=Date.now()/1e3;let i=s,l=!0,d=null;const{payload:f}=hu(r.access_token);if(f.exp&&(i=f.exp,l=i<=s),l){const{session:p,error:m}=await this._callRefreshToken(r.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!p)return{data:{user:null,session:null},error:null};d=p}else{const{data:p,error:m}=await this._getUser(r.access_token);if(m)throw m;d={access_token:r.access_token,refresh_token:r.refresh_token,user:p.user,token_type:"bearer",expires_in:i-s,expires_at:i},await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)}return{data:{user:d.user,session:d},error:null}}catch(s){if(se(s))return{data:{session:null,user:null},error:s};throw s}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async s=>{var i;if(!r){const{data:f,error:p}=s;if(p)throw p;r=(i=f.session)!==null&&i!==void 0?i:void 0}if(!(r!=null&&r.refresh_token))throw new Ur;const{session:l,error:d}=await this._callRefreshToken(r.refresh_token);return d?{data:{user:null,session:null},error:d}:l?{data:{user:l.user,session:l},error:null}:{data:{user:null,session:null},error:null}})}catch(s){if(se(s))return{data:{user:null,session:null},error:s};throw s}}async _getSessionFromURL(r,s){try{if(!zt())throw new Ya("No browser detected.");if(r.error||r.error_description||r.error_code)throw new Ya(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(s){case"implicit":if(this.flowType==="pkce")throw new $f("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ya("Not a valid implicit grant flow url.");break;default:}if(s==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new $f("No code detected.");const{data:z,error:M}=await this._exchangeCodeForSession(r.code);if(M)throw M;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:z.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:l,access_token:d,refresh_token:f,expires_in:p,expires_at:m,token_type:v}=r;if(!d||!p||!f||!v)throw new Ya("No session defined in URL");const y=Math.round(Date.now()/1e3),w=parseInt(p);let b=y+w;m&&(b=parseInt(m));const E=b-y;E*1e3<=ds&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${E}s, should have been closer to ${w}s`);const R=b-w;y-R>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",R,b,y):y-R<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",R,b,y);const{data:T,error:O}=await this._getUser(d);if(O)throw O;const Q={provider_token:i,provider_refresh_token:l,access_token:d,expires_in:w,expires_at:b,refresh_token:f,token_type:v,user:T.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:Q,redirectType:r.type},error:null}}catch(i){if(se(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const s=await pn(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&s)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async s=>{var i;const{data:l,error:d}=s;if(d)return{error:d};const f=(i=l.session)===null||i===void 0?void 0:i.access_token;if(f){const{error:p}=await this.admin.signOut(f,r);if(p&&!(Ky(p)&&(p.status===404||p.status===401||p.status===403)))return{error:p}}return r!=="others"&&(await this._removeSession(),await Mr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const s=iv(),i={id:s,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",s),this.stateChangeEmitters.delete(s)}};return this._debug("#onAuthStateChange()","registered callback with id",s),this.stateChangeEmitters.set(s,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(s)})))(),{data:{subscription:i}}}async _emitInitialSession(r){return await this._useSession(async s=>{var i,l;try{const{data:{session:d},error:f}=s;if(f)throw f;await((i=this.stateChangeEmitters.get(r))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",r,"session",d)}catch(d){await((l=this.stateChangeEmitters.get(r))===null||l===void 0?void 0:l.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",d),console.error(d)}})}async resetPasswordForEmail(r,s={}){let i=null,l=null;this.flowType==="pkce"&&([i,l]=await os(this.storage,this.storageKey,!0));try{return await ce(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:i,code_challenge_method:l,gotrue_meta_security:{captcha_token:s.captchaToken}},headers:this.headers,redirectTo:s.redirectTo})}catch(d){if(se(d))return{data:null,error:d};throw d}}async getUserIdentities(){var r;try{const{data:s,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(r=s.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(s){if(se(s))return{data:null,error:s};throw s}}async linkIdentity(r){var s;try{const{data:i,error:l}=await this._useSession(async d=>{var f,p,m,v,y;const{data:w,error:b}=d;if(b)throw b;const E=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(f=r.options)===null||f===void 0?void 0:f.redirectTo,scopes:(p=r.options)===null||p===void 0?void 0:p.scopes,queryParams:(m=r.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await ce(this.fetch,"GET",E,{headers:this.headers,jwt:(y=(v=w.session)===null||v===void 0?void 0:v.access_token)!==null&&y!==void 0?y:void 0})});if(l)throw l;return zt()&&!(!((s=r.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:r.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(se(i))return{data:{provider:r.provider,url:null},error:i};throw i}}async unlinkIdentity(r){try{return await this._useSession(async s=>{var i,l;const{data:d,error:f}=s;if(f)throw f;return await ce(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(l=(i=d.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0})})}catch(s){if(se(s))return{data:null,error:s};throw s}}async _refreshAccessToken(r){const s=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(s,"begin");try{const i=Date.now();return await uv(async l=>(l>0&&await lv(200*Math.pow(2,l-1)),this._debug(s,"refreshing attempt",l),await ce(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:hr})),(l,d)=>{const f=200*Math.pow(2,l);return d&&du(d)&&Date.now()+f-i<ds})}catch(i){if(this._debug(s,"error",i),se(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(s,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,s){const i=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:s.redirectTo,scopes:s.scopes,queryParams:s.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",s,"url",i),zt()&&!s.skipBrowserRedirect&&window.location.assign(i),{data:{provider:r,url:i},error:null}}async _recoverAndRefresh(){var r,s;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const l=await pn(this.storage,this.storageKey);if(l&&this.userStorage){let f=await pn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!f&&(f={user:l.user},await hs(this.userStorage,this.storageKey+"-user",f)),l.user=(r=f==null?void 0:f.user)!==null&&r!==void 0?r:fu()}else if(l&&!l.user&&!l.user){const f=await pn(this.storage,this.storageKey+"-user");f&&(f!=null&&f.user)?(l.user=f.user,await Mr(this.storage,this.storageKey+"-user"),await hs(this.storage,this.storageKey,l)):l.user=fu()}if(this._debug(i,"session from storage",l),!this._isValidSession(l)){this._debug(i,"session is not valid"),l!==null&&await this._removeSession();return}const d=((s=l.expires_at)!==null&&s!==void 0?s:1/0)*1e3-Date.now()<cu;if(this._debug(i,`session has${d?"":" not"} expired with margin of ${cu}s`),d){if(this.autoRefreshToken&&l.refresh_token){const{error:f}=await this._callRefreshToken(l.refresh_token);f&&(console.error(f),du(f)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",f),await this._removeSession()))}}else if(l.user&&l.user.__isUserNotAvailableProxy===!0)try{const{data:f,error:p}=await this._getUser(l.access_token);!p&&(f!=null&&f.user)?(l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(f){console.error("Error getting user data:",f),this._debug(i,"error getting user data, skipping SIGNED_IN notification",f)}else await this._notifyAllSubscribers("SIGNED_IN",l)}catch(l){this._debug(i,"error",l),console.error(l);return}finally{this._debug(i,"end")}}async _callRefreshToken(r){var s,i;if(!r)throw new Ur;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const l=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(l,"begin");try{this.refreshingDeferred=new ao;const{data:d,error:f}=await this._refreshAccessToken(r);if(f)throw f;if(!d.session)throw new Ur;await this._saveSession(d.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",d.session);const p={session:d.session,error:null};return this.refreshingDeferred.resolve(p),p}catch(d){if(this._debug(l,"error",d),se(d)){const f={session:null,error:d};return du(d)||await this._removeSession(),(s=this.refreshingDeferred)===null||s===void 0||s.resolve(f),f}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(d),d}finally{this.refreshingDeferred=null,this._debug(l,"end")}}async _notifyAllSubscribers(r,s,i=!0){const l=`#_notifyAllSubscribers(${r})`;this._debug(l,"begin",s,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:r,session:s});const d=[],f=Array.from(this.stateChangeEmitters.values()).map(async p=>{try{await p.callback(r,s)}catch(m){d.push(m)}});if(await Promise.all(f),d.length>0){for(let p=0;p<d.length;p+=1)console.error(d[p]);throw d[0]}}finally{this._debug(l,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const s=Object.assign({},r),i=s.user&&s.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&s.user&&await hs(this.userStorage,this.storageKey+"-user",{user:s.user});const l=Object.assign({},s);delete l.user;const d=zf(l);await hs(this.storage,this.storageKey,d)}else{const l=zf(s);await hs(this.storage,this.storageKey,l)}}async _removeSession(){this._debug("#_removeSession()"),await Mr(this.storage,this.storageKey),await Mr(this.storage,this.storageKey+"-code-verifier"),await Mr(this.storage,this.storageKey+"-user"),this.userStorage&&await Mr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&zt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(s){console.error("removing visibilitychange callback failed",s)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),ds);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async s=>{const{data:{session:i}}=s;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const l=Math.floor((i.expires_at*1e3-r)/ds);this._debug("#_autoRefreshTokenTick()",`access token expires in ${l} ticks, a tick lasts ${ds}ms, refresh threshold is ${Uu} ticks`),l<=Uu&&await this._callRefreshToken(i.refresh_token)})}catch(s){console.error("Auto refresh tick failed with error. This is likely a transient error.",s)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof Lp)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!zt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const s=`#_onVisibilityChanged(${r})`;this._debug(s,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(s,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,s,i){const l=[`provider=${encodeURIComponent(s)}`];if(i!=null&&i.redirectTo&&l.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&l.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[d,f]=await os(this.storage,this.storageKey),p=new URLSearchParams({code_challenge:`${encodeURIComponent(d)}`,code_challenge_method:`${encodeURIComponent(f)}`});l.push(p.toString())}if(i!=null&&i.queryParams){const d=new URLSearchParams(i.queryParams);l.push(d.toString())}return i!=null&&i.skipBrowserRedirect&&l.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${r}?${l.join("&")}`}async _unenroll(r){try{return await this._useSession(async s=>{var i;const{data:l,error:d}=s;return d?{data:null,error:d}:await ce(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token})})}catch(s){if(se(s))return{data:null,error:s};throw s}}async _enroll(r){try{return await this._useSession(async s=>{var i,l;const{data:d,error:f}=s;if(f)return{data:null,error:f};const p=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:m,error:v}=await ce(this.fetch,"POST",`${this.url}/factors`,{body:p,headers:this.headers,jwt:(i=d==null?void 0:d.session)===null||i===void 0?void 0:i.access_token});return v?{data:null,error:v}:(r.factorType==="totp"&&(!((l=m==null?void 0:m.totp)===null||l===void 0)&&l.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(s){if(se(s))return{data:null,error:s};throw s}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var i;const{data:l,error:d}=s;if(d)return{data:null,error:d};const{data:f,error:p}=await ce(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return p?{data:null,error:p}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+f.expires_in},f)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",f),{data:f,error:p})})}catch(s){if(se(s))return{data:null,error:s};throw s}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async s=>{var i;const{data:l,error:d}=s;return d?{data:null,error:d}:await ce(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token})})}catch(s){if(se(s))return{data:null,error:s};throw s}})}async _challengeAndVerify(r){const{data:s,error:i}=await this._challenge({factorId:r.factorId});return i?{data:null,error:i}:await this._verify({factorId:r.factorId,challengeId:s.id,code:r.code})}async _listFactors(){const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const i=(r==null?void 0:r.factors)||[],l=i.filter(f=>f.factor_type==="totp"&&f.status==="verified"),d=i.filter(f=>f.factor_type==="phone"&&f.status==="verified");return{data:{all:i,totp:l,phone:d},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var s,i;const{data:{session:l},error:d}=r;if(d)return{data:null,error:d};if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:f}=hu(l.access_token);let p=null;f.aal&&(p=f.aal);let m=p;((i=(s=l.user.factors)===null||s===void 0?void 0:s.filter(w=>w.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(m="aal2");const y=f.amr||[];return{data:{currentLevel:p,nextLevel:m,currentAuthenticationMethods:y},error:null}}))}async fetchJwk(r,s={keys:[]}){let i=s.keys.find(p=>p.kid===r);if(i)return i;const l=Date.now();if(i=this.jwks.keys.find(p=>p.kid===r),i&&this.jwks_cached_at+Qy>l)return i;const{data:d,error:f}=await ce(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return!d.keys||d.keys.length===0||(this.jwks=d,this.jwks_cached_at=l,i=d.keys.find(p=>p.kid===r),!i)?null:i}async getClaims(r,s={}){try{let i=r;if(!i){const{data:E,error:R}=await this.getSession();if(R||!E.session)return{data:null,error:R};i=E.session.access_token}const{header:l,payload:d,signature:f,raw:{header:p,payload:m}}=hu(i);s!=null&&s.allowExpired||gv(d.exp);const v=!l.alg||l.alg.startsWith("HS")||!l.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(l.kid,s!=null&&s.keys?{keys:s.keys}:s==null?void 0:s.jwks);if(!v){const{error:E}=await this.getUser(i);if(E)throw E;return{data:{claims:d,header:l,signature:f},error:null}}const y=yv(l.alg),w=await crypto.subtle.importKey("jwk",v,y,!0,["verify"]);if(!await crypto.subtle.verify(y,w,f,rv(`${p}.${m}`)))throw new Bu("Invalid JWT signature");return{data:{claims:d,header:l,signature:f},error:null}}catch(i){if(se(i))return{data:null,error:i};throw i}}}Ci.nextInstanceID=0;const Av=Ci;class Iv extends Av{constructor(r){super(r)}}var Lv=function(o,r,s,i){function l(d){return d instanceof s?d:new s(function(f){f(d)})}return new(s||(s=Promise))(function(d,f){function p(y){try{v(i.next(y))}catch(w){f(w)}}function m(y){try{v(i.throw(y))}catch(w){f(w)}}function v(y){y.done?d(y.value):l(y.value).then(p,m)}v((i=i.apply(o,r||[])).next())})};class $v{constructor(r,s,i){var l,d,f;if(this.supabaseUrl=r,this.supabaseKey=s,!r)throw new Error("supabaseUrl is required.");if(!s)throw new Error("supabaseKey is required.");const p=Fy(r),m=new URL(p);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const v=`sb-${m.hostname.split(".")[0]}-auth-token`,y={db:Ry,realtime:Iy,auth:Object.assign(Object.assign({},Ay),{storageKey:v}),global:Oy},w=zy(i??{},y);this.storageKey=(l=w.auth.storageKey)!==null&&l!==void 0?l:"",this.headers=(d=w.global.headers)!==null&&d!==void 0?d:{},w.accessToken?(this.accessToken=w.accessToken,this.auth=new Proxy({},{get:(b,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((f=w.auth)!==null&&f!==void 0?f:{},this.headers,w.global.fetch),this.fetch=Dy(s,this._getAccessToken.bind(this),w.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},w.realtime)),this.rest=new X0(new URL("rest/v1",m).href,{headers:this.headers,schema:w.db.schema,fetch:this.fetch}),this.storage=new Ey(this.storageUrl.href,this.headers,this.fetch,i==null?void 0:i.storage),w.accessToken||this._listenForAuthEvents()}get functions(){return new F0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,s={},i={}){return this.rest.rpc(r,s,i)}channel(r,s={config:{}}){return this.realtime.channel(r,s)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,s;return Lv(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:s,detectSessionInUrl:i,storage:l,storageKey:d,flowType:f,lock:p,debug:m},v,y){const w={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Iv({url:this.authUrl.href,headers:Object.assign(Object.assign({},w),v),storageKey:d,autoRefreshToken:r,persistSession:s,detectSessionInUrl:i,storage:l,flowType:f,lock:p,debug:m,fetch:y,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new my(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((s,i)=>{this._handleTokenChanged(s,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(r,s,i){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:r==="SIGNED_OUT"&&(this.realtime.setAuth(),s=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Mv=(o,r,s)=>new $v(o,r,s);function Dv(){if(typeof window<"u"||typeof process>"u")return!1;const o=process.version;if(o==null)return!1;const r=o.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Dv()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Uv="https://gvcswimqaxvylgxbklbz.supabase.co",Fv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd2Y3N3aW1xYXh2eWxneGJrbGJ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM3NjA1MzAsImV4cCI6MjA2OTMzNjUzMH0.UZdiGcJXUV5VYetjWXV26inmbj2yXdiT03Z6t_5Lg24",Le=Mv(Uv,Fv),mn={getDashboardOverview:async()=>{const{data:o,error:r}=await Le.functions.invoke("admin-hub-api/dashboard-overview",{method:"GET"});if(r)throw r;return o},getNotifications:async(o={})=>{const r=new URLSearchParams;o.limit&&r.append("limit",o.limit.toString()),o.priority&&r.append("priority",o.priority),o.unread_only&&r.append("unread_only","true");const{data:s,error:i}=await Le.functions.invoke(`admin-hub-api/notifications?${r.toString()}`,{method:"GET"});if(i)throw i;return s},getQuickStats:async()=>{const{data:o,error:r}=await Le.functions.invoke("admin-hub-api/quick-stats",{method:"GET"});if(r)throw r;return o},getRecentActivity:async()=>{const{data:o,error:r}=await Le.functions.invoke("admin-hub-api/recent-activity",{method:"GET"});if(r)throw r;return o},markNotificationRead:async o=>{const{data:r,error:s}=await Le.functions.invoke("admin-hub-api/mark-notification-read",{method:"POST",body:{notification_id:o}});if(s)throw s;return r},markAllNotificationsRead:async()=>{const{data:o,error:r}=await Le.functions.invoke("admin-hub-api/mark-all-notifications-read",{method:"POST"});if(r)throw r;return o}},rr={createWedding:async o=>{const{data:r,error:s}=await Le.functions.invoke("wedding-management",{method:"POST",body:{action:"create_wedding",wedding_data:o}});if(s)throw s;return r},getAllWeddings:async o=>{const{data:r,error:s}=await Le.functions.invoke("wedding-management",{method:"POST",body:{action:"get_all_weddings",filters:o}});if(s)throw s;return r},getWedding:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("wedding-management",{method:"POST",body:{action:"get_wedding",wedding_id:o,filters:r}});if(i)throw i;return s},updateWedding:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("wedding-management",{method:"POST",body:{action:"update_wedding",wedding_id:o,update_data:r}});if(i)throw i;return s},getWeddingByCode:async o=>{const{data:r,error:s}=await Le.functions.invoke("wedding-management",{method:"POST",body:{action:"get_wedding_by_code",filters:{wedding_code:o}}});if(s)throw s;return r},getWeddingDashboard:async o=>{const{data:r,error:s}=await Le.functions.invoke("wedding-management",{method:"POST",body:{action:"get_wedding_dashboard",wedding_id:o}});if(s)throw s;return r},getWeddingAnalytics:async o=>{const{data:r,error:s}=await Le.functions.invoke("wedding-management",{method:"POST",body:{action:"get_wedding_analytics",filters:o}});if(s)throw s;return r},assignCoordinator:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("wedding-management",{method:"POST",body:{action:"assign_coordinator",wedding_id:o,coordinator_id:r}});if(i)throw i;return s},invitePartyMember:async o=>{const{data:r,error:s}=await Le.functions.invoke("party-member-management",{method:"POST",body:{action:"invite_party_member",member_data:o}});if(s)throw s;return r},getPartyMembers:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("party-member-management",{method:"POST",body:{action:"get_party_member",wedding_id:o,filters:r}});if(i)throw i;return s},updatePartyMember:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("party-member-management",{method:"POST",body:{action:"update_party_member",member_id:o,update_data:r}});if(i)throw i;return s},getTasks:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("wedding-timeline-management",{method:"POST",body:{action:"get_tasks",wedding_id:o,filters:r}});if(i)throw i;return s},updateTask:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("wedding-timeline-management",{method:"POST",body:{action:"update_task",task_id:o,task_data:r}});if(i)throw i;return s},sendMessage:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("wedding-communications",{method:"POST",body:{action:"send_message",wedding_id:o,message_data:r}});if(i)throw i;return s},getMessages:async(o,r)=>{const{data:s,error:i}=await Le.functions.invoke("wedding-communications",{method:"POST",body:{action:"get_messages",wedding_id:o,filters:r}});if(i)throw i;return s}},zv=o=>Le.channel("admin_notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"admin_notifications"},o).subscribe(),oo=()=>{const o=En(),r=bt({queryKey:["dashboard-overview"],queryFn:mn.getDashboardOverview,refetchInterval:3e4}),s=bt({queryKey:["quick-stats"],queryFn:mn.getQuickStats,refetchInterval:6e4}),i=bt({queryKey:["recent-activity"],queryFn:mn.getRecentActivity,refetchInterval:15e3}),l=bt({queryKey:["notifications"],queryFn:()=>mn.getNotifications({limit:50}),refetchInterval:1e4}),d=bt({queryKey:["unread-notifications"],queryFn:()=>mn.getNotifications({unread_only:!0,limit:20}),refetchInterval:5e3}),f=ro({mutationFn:mn.markNotificationRead,onSuccess:()=>{o.invalidateQueries({queryKey:["notifications"]}),o.invalidateQueries({queryKey:["unread-notifications"]}),o.invalidateQueries({queryKey:["dashboard-overview"]})}}),p=ro({mutationFn:mn.markAllNotificationsRead,onSuccess:()=>{o.invalidateQueries({queryKey:["notifications"]}),o.invalidateQueries({queryKey:["unread-notifications"]}),o.invalidateQueries({queryKey:["dashboard-overview"]})}});return{dashboardOverview:r,quickStats:s,recentActivity:i,notifications:l,unreadNotifications:d,markNotificationRead:f,markAllNotificationsRead:p}};function Bv(){var m,v;const{dashboardOverview:o,quickStats:r}=oo(),s=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(y),i=(m=o.data)==null?void 0:m.data,l=(v=r.data)==null?void 0:v.data,d=[{title:"Today's Revenue",value:i?s(i.todayRevenue):"$0.00",icon:Gu,color:"bg-green-500",textColor:"text-green-600"},{title:"Today's Orders",value:(i==null?void 0:i.todayOrdersCount.toString())||"0",icon:vf,color:"bg-blue-500",textColor:"text-blue-600"},{title:"Pending Orders",value:(i==null?void 0:i.pendingOrdersCount.toString())||"0",icon:Ht,color:"bg-orange-500",textColor:"text-orange-600"},{title:"Urgent Alerts",value:(i==null?void 0:i.urgentNotificationsCount.toString())||"0",icon:yr,color:"bg-red-500",textColor:"text-red-600"}],f=[{title:"Weekly Revenue",value:l?s(l.weeklyRevenue):"$0.00",icon:Ps,color:"bg-purple-500",textColor:"text-purple-600"},{title:"Weekly Orders",value:(l==null?void 0:l.weeklyOrdersCount.toString())||"0",icon:vf,color:"bg-indigo-500",textColor:"text-indigo-600"},{title:"Total Customers",value:(l==null?void 0:l.totalCustomers.toString())||"0",icon:ms,color:"bg-teal-500",textColor:"text-teal-600"},{title:"Processing Queue",value:(l==null?void 0:l.processingQueueLength.toString())||"0",icon:Ht,color:"bg-amber-500",textColor:"text-amber-600"}];return o.isLoading||r.isLoading?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((y,w)=>u.jsx("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"}),u.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"})]}),u.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"})]})},w))}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((y,w)=>u.jsx("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 rounded w-24"}),u.jsx("div",{className:"h-6 bg-gray-200 rounded w-16"})]}),u.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"})]})},w))})]}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Today's Overview"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:d.map(y=>{const w=y.icon;return u.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow duration-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:y.title}),u.jsx("p",{className:`text-2xl font-bold ${y.textColor} mt-1`,children:y.value})]}),u.jsx("div",{className:`${y.color} text-white p-3 rounded-lg`,children:u.jsx(w,{className:"w-6 h-6"})})]})},y.title)})})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Weekly Performance"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:f.map(y=>{const w=y.icon;return u.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow duration-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:y.title}),u.jsx("p",{className:`text-2xl font-bold ${y.textColor} mt-1`,children:y.value})]}),u.jsx("div",{className:`${y.color} text-white p-3 rounded-lg`,children:u.jsx(w,{className:"w-6 h-6"})})]})},y.title)})})]}),(i==null?void 0:i.lastUpdated)&&u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:"text-xs text-gray-500",children:["Last updated: ",new Date(i.lastUpdated).toLocaleTimeString()]})})]})}const qv=()=>{const o=oe.useRef(null);return oe.useEffect(()=>{const s=()=>{const i=new(window.AudioContext||window.webkitAudioContext);return()=>{const p=i.createOscillator(),m=i.createGain(),v=i.createOscillator(),y=i.createGain(),w=i.createOscillator(),b=i.createGain();p.connect(m),v.connect(y),w.connect(b),m.connect(i.destination),y.connect(i.destination),b.connect(i.destination),p.frequency.setValueAtTime(587.33,i.currentTime),v.frequency.setValueAtTime(587.33*2,i.currentTime),w.frequency.setValueAtTime(587.33*3,i.currentTime),p.type="sine",v.type="sine",w.type="triangle";const E=i.currentTime;m.gain.setValueAtTime(0,E),m.gain.linearRampToValueAtTime(.3,E+.01),m.gain.exponentialRampToValueAtTime(.01,E+2),y.gain.setValueAtTime(0,E),y.gain.linearRampToValueAtTime(.15,E+.01),y.gain.exponentialRampToValueAtTime(.01,E+2*.8),b.gain.setValueAtTime(0,E),b.gain.linearRampToValueAtTime(.08,E+.01),b.gain.exponentialRampToValueAtTime(.01,E+2*.6),p.start(E),v.start(E),w.start(E),p.stop(E+2),v.stop(E+2),w.stop(E+2)}};try{const i=s();o.current={play:i}}catch(i){console.warn("Could not create audio context for notifications:",i)}},[]),{playNotificationSound:()=>{if(o.current&&typeof o.current.play=="function")try{o.current.play()}catch(s){console.warn("Could not play notification sound:",s)}}}};function Wv({isOpen:o,onClose:r}){var R,T,O,Q;const{notifications:s,unreadNotifications:i,markNotificationRead:l,markAllNotificationsRead:d}=oo(),{playNotificationSound:f}=qv(),[p,m]=oe.useState(null);oe.useEffect(()=>{const z=zv(M=>{const A=M.new;A.id!==p&&(f(),m(A.id),Notification.permission==="granted"&&new Notification(`KCT Admin: ${A.title}`,{body:A.message,icon:"/kct-logo.ico",tag:A.id}))});return()=>{z.unsubscribe()}},[f,p]),oe.useEffect(()=>{"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()},[]);const v=z=>{l.mutate(z)},y=()=>{d.mutate()},w=z=>{switch(z){case"urgent":return u.jsx(yr,{className:"w-4 h-4 text-red-500"});case"high":return u.jsx(C0,{className:"w-4 h-4 text-orange-500"});case"normal":return u.jsx(yf,{className:"w-4 h-4 text-blue-500"});default:return u.jsx(yf,{className:"w-4 h-4 text-gray-500"})}},b=z=>{switch(z){case"urgent":return"border-l-red-500 bg-red-50";case"high":return"border-l-orange-500 bg-orange-50";case"normal":return"border-l-blue-500 bg-blue-50";default:return"border-l-gray-500 bg-gray-50"}},E=z=>{const M=new Date(z),F=Math.floor((new Date().getTime()-M.getTime())/(1e3*60));if(F<1)return"Just now";if(F<60)return`${F}m ago`;const B=Math.floor(F/60);return B<24?`${B}h ago`:`${Math.floor(B/24)}d ago`};return o?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-end",children:u.jsxs("div",{className:"bg-white w-full max-w-md h-full shadow-2xl overflow-hidden flex flex-col",children:[u.jsxs("div",{className:"bg-black text-white p-4 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(S0,{className:"w-5 h-5"}),u.jsx("h2",{className:"text-lg font-semibold",children:"Notifications"}),((R=i.data)==null?void 0:R.data.length)>0&&u.jsx("span",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full",children:i.data.data.length})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[((T=i.data)==null?void 0:T.data.length)>0&&u.jsx("button",{onClick:y,className:"text-gray-300 hover:text-white transition-colors",title:"Mark all as read",children:u.jsx(N0,{className:"w-4 h-4"})}),u.jsx("button",{onClick:r,className:"text-gray-300 hover:text-white transition-colors",children:u.jsx(Yu,{className:"w-5 h-5"})})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto",children:s.isLoading?u.jsx("div",{className:"p-4 text-center text-gray-500",children:"Loading notifications..."}):((O=s.data)==null?void 0:O.data.length)===0?u.jsxs("div",{className:"p-8 text-center text-gray-500",children:[u.jsx(no,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),u.jsx("p",{children:"No notifications yet"})]}):u.jsx("div",{className:"space-y-2 p-4",children:(Q=s.data)==null?void 0:Q.data.map(z=>u.jsx("div",{className:`border-l-4 p-4 rounded-r-lg transition-all duration-200 ${z.is_read?"bg-gray-50 border-l-gray-300":b(z.priority)} ${z.is_read?"":"shadow-sm"}`,children:u.jsx("div",{className:"flex items-start justify-between",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[w(z.priority),u.jsx("h3",{className:`font-medium text-sm ${z.is_read?"text-gray-600":"text-gray-900"}`,children:z.title}),!z.is_read&&u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]}),u.jsx("p",{className:`text-sm mb-2 ${z.is_read?"text-gray-500":"text-gray-700"}`,children:z.message}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-xs text-gray-400",children:E(z.created_at)}),!z.is_read&&u.jsx("button",{onClick:()=>v(z.id),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Mark as read"})]})]})})},z.id))})})]})}):null}function Hv({className:o="",onWeddingClick:r}){const s=[{title:"Analytics Dashboard",description:"Business intelligence and reporting",url:"https://kei4wjdty1ey.space.minimax.io",icon:gp,color:"from-blue-500 to-blue-600"},{title:"Order Processing Dashboard",description:"Operational workflows and fulfillment",url:"https://i55ibre0zen6.space.minimax.io",icon:Za,color:"from-green-500 to-green-600"},{title:"Wedding Management",description:"Wedding party coordination and formalwear",onClick:r,icon:ps,color:"from-rose-500 to-rose-600",isInternal:!0}],i=[{title:"View All Orders",url:"https://i55ibre0zen6.space.minimax.io/orders",color:"bg-gray-800 hover:bg-gray-700"},{title:"Inventory Management",url:"https://i55ibre0zen6.space.minimax.io/inventory",color:"bg-gray-800 hover:bg-gray-700"},{title:"Customer Analytics",url:"https://kei4wjdty1ey.space.minimax.io/customers",color:"bg-gray-800 hover:bg-gray-700"},{title:"Revenue Reports",url:"https://kei4wjdty1ey.space.minimax.io/revenue",color:"bg-gray-800 hover:bg-gray-700"}];return u.jsxs("div",{className:`space-y-6 ${o}`,children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Main Dashboards"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:s.map(l=>{const d=l.icon;return l.isInternal?u.jsxs("button",{onClick:l.onClick,className:"group relative overflow-hidden rounded-lg bg-white shadow-lg hover:shadow-xl transition-all duration-300 text-left w-full",children:[u.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${l.color} opacity-10 group-hover:opacity-20 transition-opacity`}),u.jsxs("div",{className:"relative p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx(d,{className:"w-8 h-8 text-gray-700"}),u.jsx("div",{className:"w-4 h-4"})," "]}),u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:l.title}),u.jsx("p",{className:"text-sm text-gray-600",children:l.description})]})]},l.title):u.jsxs("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"group relative overflow-hidden rounded-lg bg-white shadow-lg hover:shadow-xl transition-all duration-300",children:[u.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${l.color} opacity-10 group-hover:opacity-20 transition-opacity`}),u.jsxs("div",{className:"relative p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx(d,{className:"w-8 h-8 text-gray-700"}),u.jsx(Tu,{className:"w-4 h-4 text-gray-400 group-hover:text-gray-600 transition-colors"})]}),u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:l.title}),u.jsx("p",{className:"text-sm text-gray-600",children:l.description})]})]},l.title)})})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:i.map(l=>u.jsxs("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:`${l.color} text-white px-4 py-3 rounded-lg text-sm font-medium text-center transition-colors duration-200 flex items-center justify-center space-x-2`,children:[u.jsx("span",{children:l.title}),u.jsx(Tu,{className:"w-3 h-3"})]},l.title))})]})]})}function Qv(){var v;const{recentActivity:o}=oo(),r=y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(parseFloat(y)),s=y=>{const w=new Date(y),E=Math.floor((new Date().getTime()-w.getTime())/(1e3*60));if(E<1)return"Just now";if(E<60)return`${E}m ago`;const R=Math.floor(E/60);return R<24?`${R}h ago`:`${Math.floor(R/24)}d ago`},i=y=>{switch(y.toLowerCase()){case"completed":return"text-green-600 bg-green-100";case"processing":return"text-blue-600 bg-blue-100";case"pending":case"pending_payment":return"text-orange-600 bg-orange-100";case"cancelled":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},l=y=>{switch(y){case"urgent":return"text-red-600";case"high":return"text-orange-600";case"normal":return"text-blue-600";default:return"text-gray-600"}};if(o.isLoading)return u.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),u.jsx("div",{className:"space-y-4",children:[...Array(5)].map((y,w)=>u.jsx("div",{className:"animate-pulse",children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded-full"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),u.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})},w))})]});const d=(v=o.data)==null?void 0:v.data,f=(d==null?void 0:d.recentOrders)||[],p=(d==null?void 0:d.recentNotifications)||[],m=[...f.map(y=>({type:"order",id:y.id,timestamp:y.created_at,data:y})),...p.map(y=>({type:"notification",id:y.id,timestamp:y.created_at,data:y}))].sort((y,w)=>new Date(w.timestamp).getTime()-new Date(y.timestamp).getTime()).slice(0,10);return u.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(Ht,{className:"w-5 h-5 mr-2"}),"Recent Activity"]}),m.length===0?u.jsxs("div",{className:"text-center py-8 text-gray-500",children:[u.jsx(Ht,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),u.jsx("p",{children:"No recent activity"})]}):u.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:m.map(y=>u.jsxs("div",{className:"flex items-start space-x-3 pb-3 border-b border-gray-100 last:border-b-0",children:[u.jsx("div",{className:"flex-shrink-0",children:y.type==="order"?u.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(A0,{className:"w-4 h-4 text-blue-600"})}):u.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:u.jsx(no,{className:"w-4 h-4 text-purple-600"})})}),u.jsx("div",{className:"flex-1 min-w-0",children:y.type==="order"?u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:["Order ",y.data.order_number]}),u.jsxs("p",{className:"text-sm text-gray-600",children:[y.data.customer_name||y.data.customer_email||"Guest Customer"," • ",r(y.data.total_amount)]}),u.jsxs("div",{className:"flex items-center justify-between mt-1",children:[u.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${i(y.data.status)}`,children:y.data.status.replace("_"," ")}),u.jsx("span",{className:"text-xs text-gray-500",children:s(y.timestamp)})]})]}):u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:y.data.title}),u.jsx("p",{className:"text-sm text-gray-600 truncate",children:y.data.message}),u.jsxs("div",{className:"flex items-center justify-between mt-1",children:[u.jsx("span",{className:`text-xs font-medium ${l(y.data.priority)}`,children:y.data.priority.toUpperCase()}),u.jsx("span",{className:"text-xs text-gray-500",children:s(y.timestamp)})]})]})})]},`${y.type}-${y.id}`))})]})}function Vv({weddingId:o}){var m;const[r,s]=oe.useState(!1),i=En(),{data:l}=bt({queryKey:["staff-assignments",o],queryFn:()=>rr.getWedding(o,{include_staff:!0})}),d=[{id:"1",name:"Sarah Johnson",role:"Senior Coordinator",email:"sarah@kct.com",phone:"(555) 123-4567",workload:8},{id:"2",name:"Michael Chen",role:"Coordinator",email:"michael@kct.com",phone:"(555) 234-5678",workload:12},{id:"3",name:"Emily Rodriguez",role:"Assistant Coordinator",email:"emily@kct.com",phone:"(555) 345-6789",workload:6}],f=ro({mutationFn:({coordinatorId:v})=>rr.assignCoordinator(o,v),onSuccess:()=>{i.invalidateQueries({queryKey:["staff-assignments",o]}),s(!1)}}),p=(m=l==null?void 0:l.data)==null?void 0:m.coordinator;return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Staff Assignment"}),u.jsxs("button",{onClick:()=>s(!0),className:"bg-black text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-800 transition-colors",children:[u.jsx(Ju,{className:"w-4 h-4"}),u.jsx("span",{children:"Assign Staff"})]})]}),p?u.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"bg-blue-100 text-blue-600 w-12 h-12 rounded-full flex items-center justify-center",children:u.jsx(I0,{className:"w-6 h-6"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Wedding Coordinator"}),u.jsx("p",{className:"text-gray-600",children:p.name}),u.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[u.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[u.jsx(Ou,{className:"w-4 h-4"}),u.jsx("span",{children:p.email})]}),u.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[u.jsx(O0,{className:"w-4 h-4"}),u.jsx("span",{children:p.phone})]})]})]})]}),u.jsx("div",{className:"text-right",children:u.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-sm font-medium rounded-full",children:"Assigned"})})]})}):u.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[u.jsx(yr,{className:"w-12 h-12 text-yellow-600 mx-auto mb-4"}),u.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Coordinator Assigned"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"This wedding needs a coordinator to manage the process."}),u.jsx("button",{onClick:()=>s(!0),className:"bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors",children:"Assign Coordinator"})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Team Workload"}),u.jsx("div",{className:"space-y-4",children:d.map(v=>{const y=Math.min(v.workload/15*100,100),w=v.workload>12;return u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"bg-gray-200 text-gray-600 w-10 h-10 rounded-full flex items-center justify-center font-medium",children:v.name.split(" ").map(b=>b[0]).join("")}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:v.name}),u.jsx("p",{className:"text-sm text-gray-600",children:v.role})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[v.workload," active weddings"]}),u.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1",children:u.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${w?"bg-red-500":y>80?"bg-yellow-500":"bg-green-500"}`,style:{width:`${y}%`}})})]}),w&&u.jsx(yr,{className:"w-5 h-5 text-red-500"})]})]},v.id)})})]}),r&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Assign Wedding Coordinator"})}),u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"space-y-4",children:d.map(v=>u.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>f.mutate({coordinatorId:v.id}),children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"bg-gray-200 text-gray-600 w-10 h-10 rounded-full flex items-center justify-center font-medium",children:v.name.split(" ").map(y=>y[0]).join("")}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:v.name}),u.jsx("p",{className:"text-sm text-gray-600",children:v.role}),u.jsxs("p",{className:"text-xs text-gray-500",children:[v.workload," active weddings"]})]})]}),v.workload>12&&u.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full",children:"Overloaded"})]},v.id))})}),u.jsx("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3",children:u.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})})]})})]})}function Kv({weddingId:o}){var y,w;const[r,s]=oe.useState("all"),{data:i}=bt({queryKey:["wedding-orders",o],queryFn:()=>rr.getWedding(o,{include_orders:!0})}),l=((y=i==null?void 0:i.data)==null?void 0:y.orders)||[],d=((w=i==null?void 0:i.data)==null?void 0:w.order_summary)||{total_orders:0,total_revenue:0,pending_orders:0,average_order_value:0},f=l.filter(b=>r==="all"||b.status===r),p=b=>{const E={pending:{color:"bg-yellow-100 text-yellow-800",label:"Pending"},confirmed:{color:"bg-blue-100 text-blue-800",label:"Confirmed"},production:{color:"bg-purple-100 text-purple-800",label:"Production"},shipping:{color:"bg-indigo-100 text-indigo-800",label:"Shipping"},delivered:{color:"bg-green-100 text-green-800",label:"Delivered"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}},R=E[b]||E.pending;return u.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${R.color}`,children:R.label})},m=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(b),v=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Order Management"}),u.jsxs("button",{className:"bg-black text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-800 transition-colors",children:[u.jsx(Tu,{className:"w-4 h-4"}),u.jsx("span",{children:"View in Order System"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.total_orders})]}),u.jsx(Za,{className:"w-8 h-8 text-blue-600"})]})}),u.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m(d.total_revenue)})]}),u.jsx(Gu,{className:"w-8 h-8 text-green-600"})]})}),u.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Orders"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.pending_orders})]}),u.jsx(Ht,{className:"w-8 h-8 text-orange-600"})]})}),u.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Order Value"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m(d.average_order_value)})]}),u.jsx(Ps,{className:"w-8 h-8 text-purple-600"})]})})]}),u.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Filter by Status:"}),u.jsxs("select",{value:r,onChange:b=>s(b.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",children:[u.jsx("option",{value:"all",children:"All Orders"}),u.jsx("option",{value:"pending",children:"Pending"}),u.jsx("option",{value:"confirmed",children:"Confirmed"}),u.jsx("option",{value:"production",children:"Production"}),u.jsx("option",{value:"shipping",children:"Shipping"}),u.jsx("option",{value:"delivered",children:"Delivered"})]})]})}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[u.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:u.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Wedding Orders"})}),f.length===0?u.jsxs("div",{className:"p-6 text-center",children:[u.jsx(Za,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),u.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),u.jsx("p",{className:"text-gray-600",children:r!=="all"?"No orders match the selected filter":"No orders have been placed yet"})]}):u.jsx("div",{className:"divide-y divide-gray-200",children:f.map(b=>u.jsxs("div",{className:"p-6 hover:bg-gray-50",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"bg-gray-100 text-gray-600 w-12 h-12 rounded-lg flex items-center justify-center",children:u.jsx(Za,{className:"w-6 h-6"})}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("h5",{className:"text-lg font-semibold text-gray-900",children:["Order #",b.order_number]}),p(b.status)]}),u.jsx("p",{className:"text-gray-600",children:b.customer_name}),u.jsxs("p",{className:"text-sm text-gray-500",children:[b.items_count," items • Placed ",v(b.created_at)]})]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-lg font-bold text-gray-900",children:m(b.total_amount)}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Expected delivery: ",v(b.expected_delivery)]}),b.shipping_address&&u.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[b.shipping_address.city,", ",b.shipping_address.state]})]})]}),b.items&&b.items.length>0&&u.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Items:"}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[b.items.slice(0,3).map((E,R)=>u.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:[E.product_name," (",E.size,")"]},R)),b.items.length>3&&u.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:["+",b.items.length-3," more"]})]})]})})]},b.id))})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Summary"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-green-800",children:"Payments Received"}),u.jsx("p",{className:"text-xl font-bold text-green-900",children:m(d.payments_received||0)})]}),u.jsx(fs,{className:"w-6 h-6 text-green-600"})]})}),u.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-yellow-800",children:"Pending Payments"}),u.jsx("p",{className:"text-xl font-bold text-yellow-900",children:m(d.pending_payments||0)})]}),u.jsx(Ht,{className:"w-6 h-6 text-yellow-600"})]})}),u.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-red-800",children:"Overdue Payments"}),u.jsx("p",{className:"text-xl font-bold text-red-900",children:m(d.overdue_payments||0)})]}),u.jsx(yr,{className:"w-6 h-6 text-red-600"})]})})]})]})]})}function Gv({weddingId:o}){var m;const[r,s]=oe.useState("30d"),{data:i}=bt({queryKey:["wedding-analytics",o,r],queryFn:()=>rr.getWedding(o,{include_analytics:!0,date_range:r})}),l=((m=i==null?void 0:i.data)==null?void 0:m.analytics)||{revenue:{total:0,growth:0,average_per_member:0,payment_completion_rate:0},timeline:{completion_rate:0,on_time_percentage:0,overdue_tasks:0,critical_path_status:"on_track"},customer_satisfaction:{overall_score:0,response_rate:0,issues_resolved:0,average_response_time:0},performance:{conversion_rate:0,referral_rate:0,repeat_customer_rate:0,coordination_efficiency:0}},d=v=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(v),f=v=>`${Math.round(v)}%`,p=v=>{const y={on_track:"text-green-600 bg-green-100",at_risk:"text-yellow-600 bg-yellow-100",behind:"text-red-600 bg-red-100"};return y[v]||y.on_track};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Wedding Analytics"}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsxs("select",{value:r,onChange:v=>s(v.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",children:[u.jsx("option",{value:"7d",children:"Last 7 days"}),u.jsx("option",{value:"30d",children:"Last 30 days"}),u.jsx("option",{value:"90d",children:"Last 90 days"}),u.jsx("option",{value:"all",children:"All time"})]}),u.jsxs("button",{className:"bg-black text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-800 transition-colors",children:[u.jsx(E0,{className:"w-4 h-4"}),u.jsx("span",{children:"Export Report"})]})]})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Revenue Performance"}),u.jsx(Gu,{className:"w-6 h-6 text-green-600"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d(l.revenue.total)}),u.jsxs("div",{className:"flex items-center mt-2",children:[u.jsx(Ps,{className:"w-4 h-4 text-green-600 mr-1"}),u.jsxs("span",{className:"text-sm text-green-600",children:["+",f(l.revenue.growth)," growth"]})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg per Member"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d(l.revenue.average_per_member)}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Average spending"})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Payment Rate"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(l.revenue.payment_completion_rate)}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Completion rate"})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Profitability"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"High"}),u.jsxs("div",{className:"flex items-center mt-2",children:[u.jsx(fs,{className:"w-4 h-4 text-green-600 mr-1"}),u.jsx("span",{className:"text-sm text-green-600",children:"Above average"})]})]})]})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Timeline Performance"}),u.jsx(Ht,{className:"w-6 h-6 text-blue-600"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completion Rate"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(l.timeline.completion_rate)}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:u.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${l.timeline.completion_rate}%`}})})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"On-Time Tasks"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(l.timeline.on_time_percentage)}),u.jsxs("div",{className:"flex items-center mt-2",children:[u.jsx(fs,{className:"w-4 h-4 text-green-600 mr-1"}),u.jsx("span",{className:"text-sm text-green-600",children:"Meeting deadlines"})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue Tasks"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.timeline.overdue_tasks}),l.timeline.overdue_tasks>0?u.jsxs("div",{className:"flex items-center mt-2",children:[u.jsx(yr,{className:"w-4 h-4 text-red-600 mr-1"}),u.jsx("span",{className:"text-sm text-red-600",children:"Needs attention"})]}):u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"All on track"})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Critical Path"}),u.jsx("div",{className:"flex items-center mt-1",children:u.jsx("span",{className:`px-2 py-1 text-sm font-medium rounded-full ${p(l.timeline.critical_path_status)}`,children:l.timeline.critical_path_status.replace("_"," ").toUpperCase()})}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Project status"})]})]})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Customer Satisfaction"}),u.jsx(ms,{className:"w-6 h-6 text-purple-600"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overall Score"}),u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[l.customer_satisfaction.overall_score,"/10"]}),u.jsxs("div",{className:"flex items-center mt-2",children:[l.customer_satisfaction.overall_score>=8?u.jsx(fs,{className:"w-4 h-4 text-green-600 mr-1"}):l.customer_satisfaction.overall_score>=6?u.jsx(Ht,{className:"w-4 h-4 text-yellow-600 mr-1"}):u.jsx(yr,{className:"w-4 h-4 text-red-600 mr-1"}),u.jsx("span",{className:`text-sm ${l.customer_satisfaction.overall_score>=8?"text-green-600":l.customer_satisfaction.overall_score>=6?"text-yellow-600":"text-red-600"}`,children:l.customer_satisfaction.overall_score>=8?"Excellent":l.customer_satisfaction.overall_score>=6?"Good":"Needs Improvement"})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Response Rate"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(l.customer_satisfaction.response_rate)}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Feedback received"})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Issues Resolved"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.customer_satisfaction.issues_resolved}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Successfully handled"})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Response Time"}),u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[l.customer_satisfaction.average_response_time,"h"]}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Support response"})]})]})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Performance Metrics"}),u.jsx(gp,{className:"w-6 h-6 text-indigo-600"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Conversion Rate"}),u.jsx("span",{className:"text-lg font-bold text-gray-900",children:f(l.performance.conversion_rate)})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${l.performance.conversion_rate}%`}})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Referral Rate"}),u.jsx("span",{className:"text-lg font-bold text-gray-900",children:f(l.performance.referral_rate)})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${l.performance.referral_rate}%`}})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Repeat Customers"}),u.jsx("span",{className:"text-lg font-bold text-gray-900",children:f(l.performance.repeat_customer_rate)})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${l.performance.repeat_customer_rate}%`}})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Coordination Efficiency"}),u.jsx("span",{className:"text-lg font-bold text-gray-900",children:f(l.performance.coordination_efficiency)})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${l.performance.coordination_efficiency}%`}})})]})]})]}),u.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(Ps,{className:"w-6 h-6 text-yellow-600 mt-1"}),u.jsxs("div",{children:[u.jsx("h4",{className:"text-lg font-semibold text-yellow-900",children:"Optimization Recommendations"}),u.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-800",children:[l.timeline.overdue_tasks>0&&u.jsxs("li",{children:["• Focus on completing ",l.timeline.overdue_tasks," overdue tasks to improve timeline performance"]}),l.revenue.payment_completion_rate<80&&u.jsx("li",{children:"• Implement automated payment reminders to improve payment completion rate"}),l.customer_satisfaction.overall_score<8&&u.jsx("li",{children:"• Review customer feedback and address common issues to boost satisfaction"}),u.jsx("li",{children:"• Continue excellent coordination - wedding is progressing well overall"})]})]})]})})]})}function Jv({weddingId:o,onBack:r}){const[s,i]=oe.useState("overview");En();const{data:l,isLoading:d}=bt({queryKey:["wedding-dashboard",o],queryFn:()=>rr.getWeddingDashboard(o)}),{data:f}=bt({queryKey:["party-members",o],queryFn:()=>rr.getPartyMembers(o,{include_measurements:!0,include_outfits:!0})}),{data:p}=bt({queryKey:["wedding-tasks",o],queryFn:()=>rr.getTasks(o,{include_member_details:!0})}),m=l==null?void 0:l.data,v=(f==null?void 0:f.data)||[],y=(p==null?void 0:p.data)||[],w=(T,O="member")=>O==="member"?{pending:"text-yellow-600 bg-yellow-100",submitted:"text-blue-600 bg-blue-100",confirmed:"text-green-600 bg-green-100",paid:"text-green-600 bg-green-100"}[T]||"text-gray-600 bg-gray-100":{pending:"text-yellow-600 bg-yellow-100",in_progress:"text-blue-600 bg-blue-100",completed:"text-green-600 bg-green-100",overdue:"text-red-600 bg-red-100"}[T]||"text-gray-600 bg-gray-100",b=T=>({low:"text-gray-600",medium:"text-yellow-600",high:"text-orange-600",critical:"text-red-600"})[T]||"text-gray-600",E=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});if(d)return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg",children:u.jsx(Eu,{className:"w-5 h-5"})}),u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 mb-2"}),u.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((T,O)=>u.jsxs("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[u.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),u.jsx("div",{className:"h-8 bg-gray-200 rounded w-16"})]},O))})]});if(!m)return u.jsxs("div",{className:"text-center py-12",children:[u.jsx(yr,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Wedding not found"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"The wedding you're looking for doesn't exist or has been removed."}),u.jsx("button",{onClick:r,className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition-colors",children:"Back to Weddings"})]});const R=[{id:"overview",label:"Overview",icon:ps},{id:"members",label:"Party Members",icon:ms},{id:"timeline",label:"Timeline",icon:Ku},{id:"communication",label:"Communication",icon:Ou},{id:"staff",label:"Staff Assignment",icon:ms},{id:"orders",label:"Orders",icon:Ht},{id:"analytics",label:"Analytics",icon:Ps}];return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:u.jsx(Eu,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ps,{className:"w-8 h-8 text-rose-600"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:m.wedding.wedding_code}),u.jsxs("p",{className:"text-gray-600",children:[E(m.wedding.wedding_date)," • ",m.wedding.days_until_wedding," days to go"]})]})]})]}),u.jsx("div",{className:"flex items-center space-x-2",children:u.jsx("span",{className:"px-3 py-1 text-sm font-medium bg-blue-100 text-blue-800 rounded-full",children:m.wedding.status})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overall Progress"}),u.jsx(fs,{className:"w-5 h-5 text-green-600"})]}),u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[m.wedding.completion_percentage,"%"]}),u.jsx("div",{className:"mt-2 bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${m.wedding.completion_percentage}%`}})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Party Members"}),u.jsx(ms,{className:"w-5 h-5 text-blue-600"})]}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.party_progress.total_members}),u.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[m.party_progress.measurements_completed," measurements complete"]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tasks"}),u.jsx(Ht,{className:"w-5 h-5 text-orange-600"})]}),u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[m.task_summary.completed_tasks,"/",m.task_summary.total_tasks]}),u.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[m.task_summary.overdue_tasks," overdue"]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Payments"}),u.jsx(fs,{className:"w-5 h-5 text-green-600"})]}),u.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[m.party_progress.payments_percentage,"%"]}),u.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[m.party_progress.payments_completed," completed"]})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow",children:[u.jsx("div",{className:"border-b border-gray-200",children:u.jsx("nav",{className:"-mb-px flex space-x-8 px-6",children:R.map(T=>{const O=T.icon;return u.jsxs("button",{onClick:()=>i(T.id),className:`flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${s===T.id?"border-black text-black":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[u.jsx(O,{className:"w-4 h-4"}),u.jsx("span",{children:T.label})]},T.id)})})}),u.jsxs("div",{className:"p-6",children:[s==="overview"&&u.jsx("div",{className:"space-y-6",children:u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"lg:col-span-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Progress Overview"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:"Measurements"}),u.jsxs("p",{className:"text-sm text-gray-600",children:[m.party_progress.measurements_completed," of ",m.party_progress.total_members," complete"]})]}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[m.party_progress.measurements_percentage,"%"]})})]}),u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:"Outfit Selection"}),u.jsxs("p",{className:"text-sm text-gray-600",children:[m.party_progress.outfits_selected," of ",m.party_progress.total_members," selected"]})]}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:"text-lg font-bold text-purple-600",children:[m.party_progress.outfits_percentage,"%"]})})]}),u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:"Payments"}),u.jsxs("p",{className:"text-sm text-gray-600",children:[m.party_progress.payments_completed," of ",m.party_progress.total_members," paid"]})]}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:"text-lg font-bold text-green-600",children:[m.party_progress.payments_percentage,"%"]})})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upcoming Deadlines"}),u.jsx("div",{className:"space-y-3",children:y.filter(T=>T.status!=="completed").slice(0,5).map(T=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900 text-sm",children:T.task_name}),u.jsx("p",{className:"text-xs text-gray-600",children:E(T.due_date)})]}),u.jsx("span",{className:`text-xs font-medium ${b(T.priority)}`,children:T.priority})]},T.id))})]})]})}),s==="members"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Party Members"}),u.jsxs("button",{className:"bg-black text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-800 transition-colors",children:[u.jsx(Ju,{className:"w-4 h-4"}),u.jsx("span",{children:"Invite Member"})]})]}),u.jsx("div",{className:"space-y-3",children:v.map(T=>u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"bg-gray-200 text-gray-600 w-10 h-10 rounded-full flex items-center justify-center font-medium",children:[T.first_name[0],T.last_name[0]]}),u.jsxs("div",{children:[u.jsxs("p",{className:"font-medium text-gray-900",children:[T.first_name," ",T.last_name]}),u.jsx("p",{className:"text-sm text-gray-600",children:T.role}),u.jsx("p",{className:"text-sm text-gray-500",children:T.email})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"text-center",children:u.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${w(T.measurements_status)}`,children:"Measurements"})}),u.jsx("div",{className:"text-center",children:u.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${w(T.outfit_status)}`,children:"Outfit"})}),u.jsx("div",{className:"text-center",children:u.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${w(T.payment_status)}`,children:"Payment"})}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[T.overall_completion_percentage,"%"]})}),u.jsx(Pu,{className:"w-4 h-4 text-gray-400"})]})]},T.id))})]}),s==="timeline"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Wedding Timeline"}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(yp,{className:"w-4 h-4 text-gray-400"}),u.jsxs("select",{className:"border border-gray-300 rounded px-3 py-1 text-sm",children:[u.jsx("option",{children:"All Tasks"}),u.jsx("option",{children:"Pending"}),u.jsx("option",{children:"In Progress"}),u.jsx("option",{children:"Completed"}),u.jsx("option",{children:"Overdue"})]})]})]}),u.jsx("div",{className:"space-y-3",children:y.map(T=>u.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:`w-3 h-3 rounded-full ${T.status==="completed"?"bg-green-600":T.status==="overdue"?"bg-red-600":"bg-gray-400"}`}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:T.task_name}),u.jsx("p",{className:"text-sm text-gray-600",children:T.description}),u.jsxs("p",{className:"text-xs text-gray-500",children:["Due: ",E(T.due_date)]})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${w(T.status,"task")}`,children:T.status.replace("_"," ")}),u.jsx("span",{className:`text-xs font-medium ${b(T.priority)}`,children:T.priority}),u.jsx(Pu,{className:"w-4 h-4 text-gray-400"})]})]},T.id))})]}),s==="communication"&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx(Ou,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Communication Center"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Send messages and updates to the wedding party"}),u.jsx("button",{className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition-colors",children:"Compose Message"})]}),s==="staff"&&u.jsx(Vv,{weddingId:o}),s==="orders"&&u.jsx(Kv,{weddingId:o}),s==="analytics"&&u.jsx(Gv,{weddingId:o})]})]})]})}function Yv({isOpen:o,onClose:r}){const s=En(),[i,l]=oe.useState({wedding_date:"",venue_name:"",venue_address:"",venue_city:"",venue_state:"",guest_count:"",formality_level:"formal",wedding_theme:"",color_scheme:["#000000","#FFFFFF"],budget_range:"",special_instructions:""}),d=ro({mutationFn:rr.createWedding,onSuccess:()=>{s.invalidateQueries({queryKey:["weddings"]}),r(),l({wedding_date:"",venue_name:"",venue_address:"",venue_city:"",venue_state:"",guest_count:"",formality_level:"formal",wedding_theme:"",color_scheme:["#000000","#FFFFFF"],budget_range:"",special_instructions:""})}}),f=m=>{m.preventDefault(),d.mutate({...i,guest_count:parseInt(i.guest_count)||0})},p=(m,v)=>{l(y=>({...y,[m]:v}))};return o?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Create New Wedding"}),u.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:u.jsx(Yu,{className:"w-6 h-6"})})]}),u.jsxs("form",{onSubmit:f,className:"p-6 space-y-6",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[u.jsx(Ku,{className:"w-4 h-4 inline mr-2"}),"Wedding Date"]}),u.jsx("input",{type:"date",value:i.wedding_date,onChange:m=>p("wedding_date",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",required:!0})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[u.jsx(P0,{className:"w-5 h-5 mr-2"}),"Venue Information"]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Venue Name"}),u.jsx("input",{type:"text",value:i.venue_name,onChange:m=>p("venue_name",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",placeholder:"The Grand Ballroom",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),u.jsx("input",{type:"text",value:i.venue_address,onChange:m=>p("venue_address",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",placeholder:"123 Wedding Avenue"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),u.jsx("input",{type:"text",value:i.venue_city,onChange:m=>p("venue_city",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",placeholder:"New York",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State"}),u.jsx("input",{type:"text",value:i.venue_state,onChange:m=>p("venue_state",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",placeholder:"NY",required:!0})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[u.jsx(ms,{className:"w-5 h-5 mr-2"}),"Wedding Details"]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Guest Count"}),u.jsx("input",{type:"number",value:i.guest_count,onChange:m=>p("guest_count",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",placeholder:"150",min:"1",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formality Level"}),u.jsxs("select",{value:i.formality_level,onChange:m=>p("formality_level",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",children:[u.jsx("option",{value:"black_tie",children:"Black Tie"}),u.jsx("option",{value:"formal",children:"Formal"}),u.jsx("option",{value:"semi_formal",children:"Semi Formal"}),u.jsx("option",{value:"cocktail",children:"Cocktail"}),u.jsx("option",{value:"casual",children:"Casual"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wedding Theme"}),u.jsx("input",{type:"text",value:i.wedding_theme,onChange:m=>p("wedding_theme",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",placeholder:"Classic Elegance, Modern Chic, Garden Party..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget Range"}),u.jsxs("select",{value:i.budget_range,onChange:m=>p("budget_range",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",children:[u.jsx("option",{value:"",children:"Select budget range"}),u.jsx("option",{value:"Under $2,500",children:"Under $2,500"}),u.jsx("option",{value:"$2,500-$5,000",children:"$2,500 - $5,000"}),u.jsx("option",{value:"$5,000-$10,000",children:"$5,000 - $10,000"}),u.jsx("option",{value:"$10,000-$20,000",children:"$10,000 - $20,000"}),u.jsx("option",{value:"$20,000+",children:"$20,000+"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Special Instructions"}),u.jsx("textarea",{value:i.special_instructions,onChange:m=>p("special_instructions",m.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",rows:3,placeholder:"Any special requirements, preferences, or notes..."})]}),u.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[u.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:d.isPending,className:"px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d.isPending?"Creating...":"Create Wedding"})]})]})]})}):null}function Xv(){var Q,z,M,A;const[o,r]=oe.useState(null),[s,i]=oe.useState(!1),[l,d]=oe.useState(""),[f,p]=oe.useState("all");En();const{data:m,isLoading:v}=bt({queryKey:["weddings",f,l],queryFn:async()=>{const F={status:f==="all"?void 0:f,search:l||void 0,limit:50};return await rr.getAllWeddings(F)}}),{data:y}=bt({queryKey:["wedding-analytics"],queryFn:()=>rr.getWeddingAnalytics()}),b=((m==null?void 0:m.data)||[]).filter(F=>{const B=F.wedding_code.toLowerCase().includes(l.toLowerCase())||F.venue_name.toLowerCase().includes(l.toLowerCase()),Z=f==="all"||F.status===f;return B&&Z}),E=F=>{const B={planning:{color:"bg-blue-100 text-blue-800",label:"Planning"},measurements:{color:"bg-yellow-100 text-yellow-800",label:"Measurements"},selection:{color:"bg-purple-100 text-purple-800",label:"Selection"},orders_placed:{color:"bg-orange-100 text-orange-800",label:"Orders Placed"},production:{color:"bg-indigo-100 text-indigo-800",label:"Production"},fulfillment:{color:"bg-teal-100 text-teal-800",label:"Fulfillment"},completed:{color:"bg-green-100 text-green-800",label:"Completed"},cancelled:{color:"bg-red-100 text-red-800",label:"Cancelled"}},Z=B[F]||B.planning;return u.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${Z.color}`,children:Z.label})},R=F=>({black_tie:"Black Tie",formal:"Formal",semi_formal:"Semi Formal",cocktail:"Cocktail",casual:"Casual"})[F]||F,T=F=>new Date(F).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),O=F=>{const B=new Date(F),Z=new Date,ye=B.getTime()-Z.getTime();return Math.ceil(ye/(1e3*60*60*24))};return o?u.jsx(Jv,{weddingId:o,onBack:()=>r(null)}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ps,{className:"w-8 h-8 text-rose-600"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Wedding Management"}),u.jsx("p",{className:"text-gray-600",children:"Coordinate wedding party formalwear"})]})]}),u.jsxs("button",{onClick:()=>i(!0),className:"bg-black text-white px-4 py-2 rounded-lg flex items-center space-x-2 hover:bg-gray-800 transition-colors",children:[u.jsx(Ju,{className:"w-4 h-4"}),u.jsx("span",{children:"New Wedding"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[u.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Weddings"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((Q=y==null?void 0:y.data)==null?void 0:Q.active_weddings)||0})]}),u.jsx(Ku,{className:"w-8 h-8 text-blue-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"This Month"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((z=y==null?void 0:y.data)==null?void 0:z.this_month)||0})]}),u.jsx(Ps,{className:"w-8 h-8 text-green-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Tasks"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((M=y==null?void 0:y.data)==null?void 0:M.pending_tasks)||0})]}),u.jsx(Ht,{className:"w-8 h-8 text-orange-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Urgent Issues"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((A=y==null?void 0:y.data)==null?void 0:A.urgent_issues)||0})]}),u.jsx(yr,{className:"w-8 h-8 text-red-600"})]})})]}),u.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"relative",children:[u.jsx(R0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),u.jsx("input",{type:"text",placeholder:"Search by wedding code or venue...",value:l,onChange:F=>d(F.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent"})]})}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(yp,{className:"w-4 h-4 text-gray-400"}),u.jsxs("select",{value:f,onChange:F=>p(F.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-black focus:border-transparent",children:[u.jsx("option",{value:"all",children:"All Status"}),u.jsx("option",{value:"planning",children:"Planning"}),u.jsx("option",{value:"measurements",children:"Measurements"}),u.jsx("option",{value:"selection",children:"Selection"}),u.jsx("option",{value:"orders_placed",children:"Orders Placed"}),u.jsx("option",{value:"production",children:"Production"}),u.jsx("option",{value:"fulfillment",children:"Fulfillment"}),u.jsx("option",{value:"completed",children:"Completed"})]})]})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[u.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Wedding Coordination"})}),v?u.jsx("div",{className:"p-6",children:u.jsx("div",{className:"space-y-4",children:[...Array(3)].map((F,B)=>u.jsxs("div",{className:"flex items-center space-x-4 animate-pulse",children:[u.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),u.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),u.jsx("div",{className:"w-20 h-6 bg-gray-200 rounded"})]},B))})}):b.length===0?u.jsxs("div",{className:"p-6 text-center",children:[u.jsx(ps,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No weddings found"}),u.jsx("p",{className:"text-gray-600 mb-4",children:l||f!=="all"?"Try adjusting your search or filters":"Get started by creating your first wedding coordination"}),u.jsx("button",{onClick:()=>i(!0),className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 transition-colors",children:"Create First Wedding"})]}):u.jsx("div",{className:"divide-y divide-gray-200",children:b.map(F=>{const B=O(F.wedding_date);return u.jsx("div",{className:"p-6 hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>r(F.id),children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"bg-rose-100 text-rose-600 p-3 rounded-lg",children:u.jsx(ps,{className:"w-6 h-6"})}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:F.wedding_code}),E(F.status)]}),u.jsxs("p",{className:"text-gray-600",children:[F.venue_name,", ",F.venue_city,", ",F.venue_state]}),u.jsxs("p",{className:"text-sm text-gray-500",children:[T(F.wedding_date)," • ",R(F.formality_level)," • ",F.guest_count," guests"]})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:B>0?`${B} days`:B===0?"Today":"Past"}),u.jsxs("p",{className:"text-sm text-gray-500",children:[F.completion_percentage,"% complete"]})]}),u.jsx("div",{className:"w-16",children:u.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${F.completion_percentage}%`}})})}),u.jsx(Pu,{className:"w-5 h-5 text-gray-400"})]})]})},F.id)})})]}),u.jsx(Yv,{isOpen:s,onClose:()=>i(!1)})]})}const Zv=new a0({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*10}}});function ex({onNotificationToggle:o,unreadCount:r,currentView:s,onBackClick:i}){const[l,d]=oe.useState(!1);return u.jsx("header",{className:"bg-black text-white shadow-lg",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[u.jsxs("div",{className:"flex items-center justify-between h-16",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[s==="wedding"&&u.jsx("button",{onClick:i,className:"p-2 text-gray-300 hover:text-white transition-colors rounded-lg hover:bg-gray-800",children:u.jsx(Eu,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-8 h-8 bg-white text-black rounded-lg flex items-center justify-center font-bold text-sm",children:"KCT"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-bold",children:"KCT Menswear"}),u.jsx("p",{className:"text-sm text-gray-300",children:s==="wedding"?"Wedding Management":"Admin Hub"})]})]})]}),u.jsx("div",{className:"hidden md:flex items-center space-x-4",children:u.jsxs("button",{onClick:o,className:"relative p-2 text-gray-300 hover:text-white transition-colors",children:[u.jsx(no,{className:"w-6 h-6"}),r>0&&u.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:r>99?"99+":r})]})}),u.jsx("div",{className:"md:hidden",children:u.jsx("button",{onClick:()=>d(!l),className:"text-gray-300 hover:text-white",children:l?u.jsx(Yu,{className:"w-6 h-6"}):u.jsx(T0,{className:"w-6 h-6"})})})]}),l&&u.jsx("div",{className:"md:hidden border-t border-gray-700 py-4",children:u.jsxs("button",{onClick:o,className:"flex items-center space-x-2 w-full px-4 py-2 text-gray-300 hover:text-white transition-colors",children:[u.jsx(no,{className:"w-5 h-5"}),u.jsx("span",{children:"Notifications"}),r>0&&u.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-1",children:r})]})})]})})}function tx(){var m;const[o,r]=oe.useState(!1),[s,i]=oe.useState("dashboard"),{unreadNotifications:l}=oo(),d=((m=l.data)==null?void 0:m.data.length)||0,f=()=>{i("wedding")},p=()=>{i("dashboard")};return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx(ex,{onNotificationToggle:()=>r(!o),unreadCount:d,currentView:s,onBackClick:p}),u.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s==="dashboard"?u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome to KCT Admin Hub"}),u.jsx("p",{className:"text-gray-600",children:"Central command center for all administrative operations"})]}),u.jsx(Bv,{}),u.jsx(Hv,{onWeddingClick:f}),u.jsx(Qv,{})]}):u.jsx(Xv,{})}),u.jsx(Wv,{isOpen:o,onClose:()=>r(!1)})]})}function rx(){return u.jsx(d0,{client:Zv,children:u.jsx(tx,{})})}Bg.createRoot(document.getElementById("root")).render(u.jsx(oe.StrictMode,{children:u.jsx(Wg,{children:u.jsx(rx,{})})}));
